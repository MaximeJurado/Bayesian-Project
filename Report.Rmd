---
title: "Bayesian Analysis Project"
author: "Maxime Jurado and Mathieu Marauri"
date: "Tuesday, May 26, 2015"
output:
  pdf_document:
    fig_caption: yes
    keep_tex: no
    number_sections: yes
    toc: yes
header-includes: \usepackage{float} \usepackage{graphicx}

---

```{r initial_chunk, echo = FALSE, warning = FALSE, message = FALSE}
library("knitr")
library("ggplot2")
library("xtable")
library("dplyr")
library("gridExtra")
library("xtable")
opts_chunk$set(echo = FALSE, eval = TRUE, warning = FALSE, message = FALSE)
options("xtable.comment" = FALSE)
options("xtable.table.placement" = "H")
```

```{r data}
data <- read.csv2("Data/data.csv",header=TRUE)
data <- subset(data,time!="TP")
data1 <- data[rep(1:nrow(data),each=5),]
data2 <- data.frame(data$X1,data$X2,data$X3,data$X4,data$X5)
data3 <- data.frame(data1$id,data1$time,data1$sexe)
vec <- NULL
for(i in 1:nrow(data2)){
  vec1 <- data2[i,]
  vec <- c(vec,t(vec1))
}
vec <- as.data.frame(vec)
data4 <- data.frame(data3,vec)
cat <- c(rep(c(1,2,3,4,5),132))
data <- data.frame(data4,cat)
colnames(data) <- c("id","time","sexe","salary","spc")
attach(data)
salary<-as.numeric(salary)
```

# Abstract

# Introduction

# Dataset
\label{dataset}

The dataset comes from the *Institut National de la Statistique et des Etudes Economiques* or INSEE in France. It s the statistical instuitute of France. The dataset contains 33 sectors of activity that are identified by the *id* variable. The classification can be found in table \ref{indexSector}. 

The variables reported in this study are listed below:

* Time is an indicator which takes value 1 for a full-time work and 0 for a part-time work. _time_
* Sexe is a binary variable with value 1 for male and 0 for female. _sexe_
* Socio-Professional Category: it takes values between 1 and 5. Table \ref{indexCat} shows the classification. _spc_
* Salary: it is the response variable. _salary_

The salary is the average gross income for an hour. For instance it can be the average income of female employees working full-time in the extractive industry.


# Descriptive analysis

We can explore the dataset trough a descriptive analysis.

```{r fig1,echo=FALSE,fig.cap="Boxplot of the salary for each category",fig.pos="H",fig.align='left'}

theme <- theme(plot.title = element_text(size=16, face="bold"), axis.title.x = element_text(
              size=15), axis.title.y = element_text(size=15), axis.text.x = element_text(
              size=15, face="bold"),axis.text.y = element_text(size=15, face="bold"))

ggplot(data, aes(factor(spc), salary)) + geom_boxplot(aes(fill = factor(spc))) + 
  xlab("Socio-Professional Category") + ylab("Salary") + guides(fill=guide_legend(title=NULL)) + 
  ggtitle("Boxplot of the salary for each category") + theme


```

```{r fig2,echo=FALSE,fig.cap="Boxplot of the salary for each SPC and each time",fig.pos="H",fig.align='left'}
ggplot(data, aes(factor(spc), salary)) + geom_boxplot(aes(fill = factor(time))) +
  labs(x="SPC", y="Salary", title="Boxplot of the salary for each SPC and each time") + 
  theme + scale_fill_manual(name="Time", values=c("orange", "mediumpurple"), labels=c("0"="Part-time", 
  "1"="Full-time"))
```

```{r fig3,echo=FALSE,fig.cap="Evolution of the salary for each SPC by id",fig.pos="H",fig.align='left'}
datamean <- aggregate(data.frame(salaryMean = data$salary), by = list(id = data$id, spc = data$spc), 
                      mean)

ggplot(datamean, aes(spc, salaryMean)) + facet_wrap(facets=~ id, ncol=10) + 
  geom_line(colour="blue") + geom_point(colour="red") + theme

```

# Statistical methods

# Bayesian model 

# Bayesian model with random effects

# COnclusion

# Bibliographie

# Appendix

## Classification tables

Here are presented the classification tables for the Socio-Professional Categories (Table \ref{tableIndexSpc}) and for the Sectors (Table \ref{tableIndexSectors}).

```{r classification table spc, results='asis'}
categories <- read.table("Data/Index SCP.txt", sep="-", header=FALSE)
categories <- data.frame(categories$V2)
colnames(categories) <- "Category"
print(xtable(categories, align=c("c","c"), caption="Classification table of the Socio-Professional Categories. \\label{tableIndexSpc}"), comment = FALSE, , table.placement = "H")
```

```{r classification table sectors, results='asis'}
sectors <- read.table("Data/Index Sectors.txt", sep=";", header=FALSE)
sectors <- data.frame(sectors$V2)
colnames(sectors) <- "Sector"
print(xtable(sectors, align=c("c","c"), caption="Classification table of the Sectors. \\label{tableIndexSectors}"), comment = FALSE, , table.placement = "H")
```

Reurn to section \nameref{dataset}.
